if login then

local diskiconactiv = false
keepmenu = false
local deskback = true

function DrawMenu()
term.setCursorPos(1,1)
term.setBackgroundColor(body)
term.setTextColor(bodytxt)
print(OStag)
print("System      >")
print("Programs    >")
print("Time         ")
write("Shell       ")
if admin then print(" ") else print("!") end
print(" ----------- ")
print("Logoff       ")
print("Reboot       ")
print("Shutdown     ")
end

local function menuundo()
 term.setCursorPos(1,1)
 term.setBackgroundColor(tbar)
 term.setTextColor(tbartxt)
 print(OStag)
 paintutils.drawImage(Wallpaper,1,2)
 term.setCursorPos(1,18)
 term.setBackgroundColor(tbar)
 print(UserName)
 if fs.exists("/disk") then
  paintutils.drawImage(disklogo,2,4)
  term.setCursorPos(2,8)
  term.setBackgroundColor(mbar)
  term.setTextColor(mbartxt)
  print("Disk")
  diskiconactiv = true
 else
  if diskiconactiv then
   paintutils.drawImage(Wallpaper,1,2)
   term.setBackgroundColor(tbar)
   term.setTextColor(tbartxt)
   term.setCursorPos(1,18)
   print(UserName)
  else
  end
 end
end

DrawMenu()

while true do
local event, button, X, Y = os.pullEvent("mouse_click")
XY = X..","..Y

 -- System

if X >= 1 and X < 14 and Y == 2 then
 shell.run("/ReboOSt/sysmnu")
 if keepmenu == true then DrawMenu() else menuundo() break end

 -- Programs

elseif X >= 1 and X < 14 and Y == 3 then
 shell.run("/ReboOSt/progmnu")
 if keepmenu == true then DrawMenu() else menuundo() break end

 -- Time

elseif X >= 1 and X < 14 and Y == 4 then
 menuundo()
 shell.run("/ReboOSt/time")
 break

 -- Shell

elseif X >= 1 and X < 14 and Y == 5 then
 if admin then
  crash = false
  break
 end

 -- Logoff

elseif X >= 1 and X < 14 and Y == 7 then
 menuundo()
 term.setBackgroundColor(wico)
 term.setTextColor(wicotxt)
 term.setCursorPos(14,7)
 print("        Logoff        ")
 term.setBackgroundColor(wicotxt)
 term.setTextColor(wico)
 term.setCursorPos(14,8)
 print("                      ")
 term.setCursorPos(14,9)
 print("    Logging off...    ")
 term.setCursorPos(14,10)
 print("                      ")
 sleep(1.2)
 login = false
 break

 -- Reboot

elseif X >= 1 and X < 14 and Y == 8 then
 menuundo()
 shell.run("/ReboOSt/reboot")
 break

 -- Shutdown

elseif X >= 1 and X < 14 and Y == 9 then
 menuundo()
 shell.run("/ReboOSt/shut-off")
 break

 -- Go back

else
break
end end
else
 term.setTextColor(16384)
 term.setBackgroundColor(32768)
 print("You don't even have ReboOSt started!")
 term.setTextColor(1)
end
